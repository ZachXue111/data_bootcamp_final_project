{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib as mpl\n",
    "import matplotlib.pyplot as plt\n",
    "import statsmodels.formula.api as smf\n",
    "%matplotlib inline\n",
    "stock_prices = pd.read_csv(\"stock_prices_latest.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>date</th>\n",
       "      <th>open</th>\n",
       "      <th>high</th>\n",
       "      <th>low</th>\n",
       "      <th>close</th>\n",
       "      <th>close_adjusted</th>\n",
       "      <th>volume</th>\n",
       "      <th>split_coefficient</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2016-05-16</td>\n",
       "      <td>50.80</td>\n",
       "      <td>51.96</td>\n",
       "      <td>50.7500</td>\n",
       "      <td>51.83</td>\n",
       "      <td>49.7013</td>\n",
       "      <td>20032017</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2002-01-16</td>\n",
       "      <td>68.85</td>\n",
       "      <td>69.84</td>\n",
       "      <td>67.8500</td>\n",
       "      <td>67.87</td>\n",
       "      <td>22.5902</td>\n",
       "      <td>30977700</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2001-09-18</td>\n",
       "      <td>53.41</td>\n",
       "      <td>55.00</td>\n",
       "      <td>53.1700</td>\n",
       "      <td>54.32</td>\n",
       "      <td>18.0802</td>\n",
       "      <td>41591300</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2007-10-26</td>\n",
       "      <td>36.01</td>\n",
       "      <td>36.03</td>\n",
       "      <td>34.5600</td>\n",
       "      <td>35.03</td>\n",
       "      <td>27.2232</td>\n",
       "      <td>288121200</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2014-06-27</td>\n",
       "      <td>41.61</td>\n",
       "      <td>42.29</td>\n",
       "      <td>41.5100</td>\n",
       "      <td>42.25</td>\n",
       "      <td>38.6773</td>\n",
       "      <td>74640000</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23528430</th>\n",
       "      <td>FATE</td>\n",
       "      <td>2020-11-04</td>\n",
       "      <td>45.92</td>\n",
       "      <td>51.00</td>\n",
       "      <td>43.1101</td>\n",
       "      <td>49.82</td>\n",
       "      <td>49.8200</td>\n",
       "      <td>1275276</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23528431</th>\n",
       "      <td>FATE</td>\n",
       "      <td>2020-11-10</td>\n",
       "      <td>50.28</td>\n",
       "      <td>52.97</td>\n",
       "      <td>49.7000</td>\n",
       "      <td>52.61</td>\n",
       "      <td>52.6100</td>\n",
       "      <td>923331</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23528432</th>\n",
       "      <td>FATE</td>\n",
       "      <td>2020-11-09</td>\n",
       "      <td>49.41</td>\n",
       "      <td>52.48</td>\n",
       "      <td>48.1000</td>\n",
       "      <td>50.69</td>\n",
       "      <td>50.6900</td>\n",
       "      <td>795234</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23528433</th>\n",
       "      <td>FATE</td>\n",
       "      <td>2020-11-12</td>\n",
       "      <td>53.52</td>\n",
       "      <td>54.63</td>\n",
       "      <td>51.1000</td>\n",
       "      <td>51.98</td>\n",
       "      <td>51.9800</td>\n",
       "      <td>634022</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23528434</th>\n",
       "      <td>FATE</td>\n",
       "      <td>2020-11-06</td>\n",
       "      <td>51.12</td>\n",
       "      <td>51.15</td>\n",
       "      <td>47.2000</td>\n",
       "      <td>48.28</td>\n",
       "      <td>48.2800</td>\n",
       "      <td>586830</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>23528435 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         symbol        date   open   high      low  close  close_adjusted  \\\n",
       "0          MSFT  2016-05-16  50.80  51.96  50.7500  51.83         49.7013   \n",
       "1          MSFT  2002-01-16  68.85  69.84  67.8500  67.87         22.5902   \n",
       "2          MSFT  2001-09-18  53.41  55.00  53.1700  54.32         18.0802   \n",
       "3          MSFT  2007-10-26  36.01  36.03  34.5600  35.03         27.2232   \n",
       "4          MSFT  2014-06-27  41.61  42.29  41.5100  42.25         38.6773   \n",
       "...         ...         ...    ...    ...      ...    ...             ...   \n",
       "23528430   FATE  2020-11-04  45.92  51.00  43.1101  49.82         49.8200   \n",
       "23528431   FATE  2020-11-10  50.28  52.97  49.7000  52.61         52.6100   \n",
       "23528432   FATE  2020-11-09  49.41  52.48  48.1000  50.69         50.6900   \n",
       "23528433   FATE  2020-11-12  53.52  54.63  51.1000  51.98         51.9800   \n",
       "23528434   FATE  2020-11-06  51.12  51.15  47.2000  48.28         48.2800   \n",
       "\n",
       "             volume  split_coefficient  \n",
       "0          20032017                1.0  \n",
       "1          30977700                1.0  \n",
       "2          41591300                1.0  \n",
       "3         288121200                1.0  \n",
       "4          74640000                1.0  \n",
       "...             ...                ...  \n",
       "23528430    1275276                1.0  \n",
       "23528431     923331                1.0  \n",
       "23528432     795234                1.0  \n",
       "23528433     634022                1.0  \n",
       "23528434     586830                1.0  \n",
       "\n",
       "[23528435 rows x 9 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "stock_prices = stock_prices.dropna()\n",
    "stock_prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Symbol</th>\n",
       "      <th>Name</th>\n",
       "      <th>LastSale</th>\n",
       "      <th>MarketCap</th>\n",
       "      <th>ADR TSO</th>\n",
       "      <th>IPOyear</th>\n",
       "      <th>Sector</th>\n",
       "      <th>Industry</th>\n",
       "      <th>Summary Quote</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>American Software, Inc.</td>\n",
       "      <td>10.1600</td>\n",
       "      <td>2.994201e+08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>http://www.nasdaq.com/symbol/amswa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>JASNW</td>\n",
       "      <td>Jason Industries, Inc.</td>\n",
       "      <td>0.0473</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013.0</td>\n",
       "      <td>Consumer Durables</td>\n",
       "      <td>Miscellaneous manufacturing industries</td>\n",
       "      <td>http://www.nasdaq.com/symbol/jasnw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MU</td>\n",
       "      <td>Micron Technology, Inc.</td>\n",
       "      <td>28.4300</td>\n",
       "      <td>3.135123e+10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Semiconductors</td>\n",
       "      <td>http://www.nasdaq.com/symbol/mu</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ICBK</td>\n",
       "      <td>County Bancorp, Inc.</td>\n",
       "      <td>28.4400</td>\n",
       "      <td>1.865702e+08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015.0</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Major Banks</td>\n",
       "      <td>http://www.nasdaq.com/symbol/icbk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DTEA</td>\n",
       "      <td>DAVIDsTEA Inc.</td>\n",
       "      <td>7.6000</td>\n",
       "      <td>1.901521e+08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015.0</td>\n",
       "      <td>Consumer Non-Durables</td>\n",
       "      <td>Food Chains</td>\n",
       "      <td>http://www.nasdaq.com/symbol/dtea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3189</th>\n",
       "      <td>JXSB</td>\n",
       "      <td>Jacksonville Bancorp Inc.</td>\n",
       "      <td>30.7500</td>\n",
       "      <td>5.540231e+07</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Savings Institutions</td>\n",
       "      <td>http://www.nasdaq.com/symbol/jxsb</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3190</th>\n",
       "      <td>KVHI</td>\n",
       "      <td>KVH Industries, Inc.</td>\n",
       "      <td>8.1000</td>\n",
       "      <td>1.369102e+08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1996.0</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Radio And Television Broadcasting And Communic...</td>\n",
       "      <td>http://www.nasdaq.com/symbol/kvhi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3191</th>\n",
       "      <td>CPST</td>\n",
       "      <td>Capstone Turbine Corporation</td>\n",
       "      <td>0.7600</td>\n",
       "      <td>2.715101e+07</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>Energy</td>\n",
       "      <td>Industrial Machinery/Components</td>\n",
       "      <td>http://www.nasdaq.com/symbol/cpst</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3192</th>\n",
       "      <td>CBSH</td>\n",
       "      <td>Commerce Bancshares, Inc.</td>\n",
       "      <td>54.9800</td>\n",
       "      <td>5.595854e+09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Major Banks</td>\n",
       "      <td>http://www.nasdaq.com/symbol/cbsh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3193</th>\n",
       "      <td>ENG</td>\n",
       "      <td>ENGlobal Corporation</td>\n",
       "      <td>1.7201</td>\n",
       "      <td>4.676966e+07</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>http://www.nasdaq.com/symbol/eng</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3194 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Symbol                          Name  LastSale     MarketCap  ADR TSO  \\\n",
       "0     AMSWA       American Software, Inc.   10.1600  2.994201e+08      NaN   \n",
       "1     JASNW        Jason Industries, Inc.    0.0473  0.000000e+00      NaN   \n",
       "2        MU       Micron Technology, Inc.   28.4300  3.135123e+10      NaN   \n",
       "3      ICBK          County Bancorp, Inc.   28.4400  1.865702e+08      NaN   \n",
       "4      DTEA                DAVIDsTEA Inc.    7.6000  1.901521e+08      NaN   \n",
       "...     ...                           ...       ...           ...      ...   \n",
       "3189   JXSB     Jacksonville Bancorp Inc.   30.7500  5.540231e+07      NaN   \n",
       "3190   KVHI          KVH Industries, Inc.    8.1000  1.369102e+08      NaN   \n",
       "3191   CPST  Capstone Turbine Corporation    0.7600  2.715101e+07      NaN   \n",
       "3192   CBSH     Commerce Bancshares, Inc.   54.9800  5.595854e+09      NaN   \n",
       "3193    ENG          ENGlobal Corporation    1.7201  4.676966e+07      NaN   \n",
       "\n",
       "      IPOyear                 Sector  \\\n",
       "0         NaN             Technology   \n",
       "1      2013.0      Consumer Durables   \n",
       "2         NaN             Technology   \n",
       "3      2015.0                Finance   \n",
       "4      2015.0  Consumer Non-Durables   \n",
       "...       ...                    ...   \n",
       "3189      NaN                Finance   \n",
       "3190   1996.0             Technology   \n",
       "3191   2000.0                 Energy   \n",
       "3192      NaN                Finance   \n",
       "3193      NaN      Consumer Services   \n",
       "\n",
       "                                               Industry  \\\n",
       "0               Computer Software: Prepackaged Software   \n",
       "1                Miscellaneous manufacturing industries   \n",
       "2                                        Semiconductors   \n",
       "3                                           Major Banks   \n",
       "4                                           Food Chains   \n",
       "...                                                 ...   \n",
       "3189                               Savings Institutions   \n",
       "3190  Radio And Television Broadcasting And Communic...   \n",
       "3191                    Industrial Machinery/Components   \n",
       "3192                                        Major Banks   \n",
       "3193                      Military/Government/Technical   \n",
       "\n",
       "                           Summary Quote  \n",
       "0     http://www.nasdaq.com/symbol/amswa  \n",
       "1     http://www.nasdaq.com/symbol/jasnw  \n",
       "2        http://www.nasdaq.com/symbol/mu  \n",
       "3      http://www.nasdaq.com/symbol/icbk  \n",
       "4      http://www.nasdaq.com/symbol/dtea  \n",
       "...                                  ...  \n",
       "3189   http://www.nasdaq.com/symbol/jxsb  \n",
       "3190   http://www.nasdaq.com/symbol/kvhi  \n",
       "3191   http://www.nasdaq.com/symbol/cpst  \n",
       "3192   http://www.nasdaq.com/symbol/cbsh  \n",
       "3193    http://www.nasdaq.com/symbol/eng  \n",
       "\n",
       "[3194 rows x 9 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nasdaq_sectors = pd.read_csv(\"nasdaq-companies.csv\", sep=';')\n",
    "nasdaq_sectors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Nasdaq Traded</th>\n",
       "      <th>Symbol</th>\n",
       "      <th>Security Name</th>\n",
       "      <th>Listing Exchange</th>\n",
       "      <th>Market Category</th>\n",
       "      <th>ETF</th>\n",
       "      <th>Round Lot Size</th>\n",
       "      <th>Test Issue</th>\n",
       "      <th>Financial Status</th>\n",
       "      <th>CQS Symbol</th>\n",
       "      <th>NASDAQ Symbol</th>\n",
       "      <th>NextShares</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Y</td>\n",
       "      <td>A</td>\n",
       "      <td>Agilent Technologies, Inc. Common Stock</td>\n",
       "      <td>N</td>\n",
       "      <td></td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>A</td>\n",
       "      <td>A</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Y</td>\n",
       "      <td>AA</td>\n",
       "      <td>Alcoa Corporation Common Stock</td>\n",
       "      <td>N</td>\n",
       "      <td></td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AA</td>\n",
       "      <td>AA</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Y</td>\n",
       "      <td>AAAU</td>\n",
       "      <td>Perth Mint Physical Gold ETF</td>\n",
       "      <td>P</td>\n",
       "      <td></td>\n",
       "      <td>Y</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AAAU</td>\n",
       "      <td>AAAU</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Y</td>\n",
       "      <td>AACG</td>\n",
       "      <td>ATA Creativity Global - American Depositary Sh...</td>\n",
       "      <td>Q</td>\n",
       "      <td>G</td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AACG</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Y</td>\n",
       "      <td>AADR</td>\n",
       "      <td>AdvisorShares Dorsey Wright ADR ETF</td>\n",
       "      <td>P</td>\n",
       "      <td></td>\n",
       "      <td>Y</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AADR</td>\n",
       "      <td>AADR</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8044</th>\n",
       "      <td>Y</td>\n",
       "      <td>ZUO</td>\n",
       "      <td>Zuora, Inc. Class A Common Stock</td>\n",
       "      <td>N</td>\n",
       "      <td></td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ZUO</td>\n",
       "      <td>ZUO</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8045</th>\n",
       "      <td>Y</td>\n",
       "      <td>ZVO</td>\n",
       "      <td>Zovio Inc. - Common Stock</td>\n",
       "      <td>Q</td>\n",
       "      <td>Q</td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ZVO</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8046</th>\n",
       "      <td>Y</td>\n",
       "      <td>ZYME</td>\n",
       "      <td>Zymeworks Inc. Common Shares</td>\n",
       "      <td>N</td>\n",
       "      <td></td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ZYME</td>\n",
       "      <td>ZYME</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8047</th>\n",
       "      <td>Y</td>\n",
       "      <td>ZYNE</td>\n",
       "      <td>Zynerba Pharmaceuticals, Inc. - Common Stock</td>\n",
       "      <td>Q</td>\n",
       "      <td>G</td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ZYNE</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8048</th>\n",
       "      <td>Y</td>\n",
       "      <td>ZYXI</td>\n",
       "      <td>Zynex, Inc. - Common Stock</td>\n",
       "      <td>Q</td>\n",
       "      <td>S</td>\n",
       "      <td>N</td>\n",
       "      <td>100.0</td>\n",
       "      <td>N</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ZYXI</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8049 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Nasdaq Traded Symbol                                      Security Name  \\\n",
       "0                Y      A            Agilent Technologies, Inc. Common Stock   \n",
       "1                Y     AA                    Alcoa Corporation Common Stock    \n",
       "2                Y   AAAU                       Perth Mint Physical Gold ETF   \n",
       "3                Y   AACG  ATA Creativity Global - American Depositary Sh...   \n",
       "4                Y   AADR                AdvisorShares Dorsey Wright ADR ETF   \n",
       "...            ...    ...                                                ...   \n",
       "8044             Y    ZUO                   Zuora, Inc. Class A Common Stock   \n",
       "8045             Y    ZVO                          Zovio Inc. - Common Stock   \n",
       "8046             Y   ZYME                       Zymeworks Inc. Common Shares   \n",
       "8047             Y   ZYNE       Zynerba Pharmaceuticals, Inc. - Common Stock   \n",
       "8048             Y   ZYXI                         Zynex, Inc. - Common Stock   \n",
       "\n",
       "     Listing Exchange Market Category ETF  Round Lot Size Test Issue  \\\n",
       "0                   N                   N           100.0          N   \n",
       "1                   N                   N           100.0          N   \n",
       "2                   P                   Y           100.0          N   \n",
       "3                   Q               G   N           100.0          N   \n",
       "4                   P                   Y           100.0          N   \n",
       "...               ...             ...  ..             ...        ...   \n",
       "8044                N                   N           100.0          N   \n",
       "8045                Q               Q   N           100.0          N   \n",
       "8046                N                   N           100.0          N   \n",
       "8047                Q               G   N           100.0          N   \n",
       "8048                Q               S   N           100.0          N   \n",
       "\n",
       "     Financial Status CQS Symbol NASDAQ Symbol NextShares  \n",
       "0                 NaN          A             A          N  \n",
       "1                 NaN         AA            AA          N  \n",
       "2                 NaN       AAAU          AAAU          N  \n",
       "3                   N        NaN          AACG          N  \n",
       "4                 NaN       AADR          AADR          N  \n",
       "...               ...        ...           ...        ...  \n",
       "8044              NaN        ZUO           ZUO          N  \n",
       "8045                N        NaN           ZVO          N  \n",
       "8046              NaN       ZYME          ZYME          N  \n",
       "8047                N        NaN          ZYNE          N  \n",
       "8048                N        NaN          ZYXI          N  \n",
       "\n",
       "[8049 rows x 12 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nasdaq_stocks = pd.read_csv(\"nasdaq_stocks.csv\")\n",
    "nasdaq_stocks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>sector</th>\n",
       "      <th>industry</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>JASNW</td>\n",
       "      <td>Consumer Durables</td>\n",
       "      <td>Miscellaneous manufacturing industries</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MU</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Semiconductors</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ICBK</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Major Banks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DTEA</td>\n",
       "      <td>Consumer Non-Durables</td>\n",
       "      <td>Food Chains</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3189</th>\n",
       "      <td>JXSB</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Savings Institutions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3190</th>\n",
       "      <td>KVHI</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Radio And Television Broadcasting And Communic...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3191</th>\n",
       "      <td>CPST</td>\n",
       "      <td>Energy</td>\n",
       "      <td>Industrial Machinery/Components</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3192</th>\n",
       "      <td>CBSH</td>\n",
       "      <td>Finance</td>\n",
       "      <td>Major Banks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3193</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3194 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     symbol                 sector  \\\n",
       "0     AMSWA             Technology   \n",
       "1     JASNW      Consumer Durables   \n",
       "2        MU             Technology   \n",
       "3      ICBK                Finance   \n",
       "4      DTEA  Consumer Non-Durables   \n",
       "...     ...                    ...   \n",
       "3189   JXSB                Finance   \n",
       "3190   KVHI             Technology   \n",
       "3191   CPST                 Energy   \n",
       "3192   CBSH                Finance   \n",
       "3193    ENG      Consumer Services   \n",
       "\n",
       "                                               industry  \n",
       "0               Computer Software: Prepackaged Software  \n",
       "1                Miscellaneous manufacturing industries  \n",
       "2                                        Semiconductors  \n",
       "3                                           Major Banks  \n",
       "4                                           Food Chains  \n",
       "...                                                 ...  \n",
       "3189                               Savings Institutions  \n",
       "3190  Radio And Television Broadcasting And Communic...  \n",
       "3191                    Industrial Machinery/Components  \n",
       "3192                                        Major Banks  \n",
       "3193                      Military/Government/Technical  \n",
       "\n",
       "[3194 rows x 3 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#nasdaq_sectors = nasdaq_sectors.drop(columns = ['Name', 'LastSale', 'MarketCap', 'ADR TSO', 'IPOyear', 'Summary Quote'])\n",
    "#nasdaq_sectors = nasdaq_sectors.rename(columns={\"Symbol\": \"symbol\", \"Sector\": \"sector\", \"Industry\":\"industry\"})\n",
    "#Feel free to uncomment these two lines \n",
    "nasdaq_sectors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>sector</th>\n",
       "      <th>industry</th>\n",
       "      <th>date</th>\n",
       "      <th>open</th>\n",
       "      <th>high</th>\n",
       "      <th>low</th>\n",
       "      <th>close</th>\n",
       "      <th>close_adjusted</th>\n",
       "      <th>volume</th>\n",
       "      <th>split_coefficient</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>2004-04-01</td>\n",
       "      <td>6.6400</td>\n",
       "      <td>7.6000</td>\n",
       "      <td>6.6400</td>\n",
       "      <td>7.4700</td>\n",
       "      <td>3.7886</td>\n",
       "      <td>136400</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>2015-03-24</td>\n",
       "      <td>10.2200</td>\n",
       "      <td>10.5400</td>\n",
       "      <td>10.0600</td>\n",
       "      <td>10.2600</td>\n",
       "      <td>9.1404</td>\n",
       "      <td>255045</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>2006-04-19</td>\n",
       "      <td>7.4000</td>\n",
       "      <td>7.4100</td>\n",
       "      <td>7.2870</td>\n",
       "      <td>7.4100</td>\n",
       "      <td>4.1291</td>\n",
       "      <td>80300</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>2014-08-08</td>\n",
       "      <td>9.1700</td>\n",
       "      <td>9.3400</td>\n",
       "      <td>9.1700</td>\n",
       "      <td>9.2900</td>\n",
       "      <td>8.0998</td>\n",
       "      <td>28900</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AMSWA</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Computer Software: Prepackaged Software</td>\n",
       "      <td>2010-03-16</td>\n",
       "      <td>5.9200</td>\n",
       "      <td>5.9600</td>\n",
       "      <td>5.7500</td>\n",
       "      <td>5.8800</td>\n",
       "      <td>4.0623</td>\n",
       "      <td>34900</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10164997</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>2020-11-03</td>\n",
       "      <td>0.8173</td>\n",
       "      <td>0.8400</td>\n",
       "      <td>0.7975</td>\n",
       "      <td>0.8305</td>\n",
       "      <td>0.8305</td>\n",
       "      <td>151928</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10164998</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>0.8880</td>\n",
       "      <td>0.8880</td>\n",
       "      <td>0.8500</td>\n",
       "      <td>0.8760</td>\n",
       "      <td>0.8760</td>\n",
       "      <td>426193</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10164999</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>2020-11-04</td>\n",
       "      <td>0.8354</td>\n",
       "      <td>0.8600</td>\n",
       "      <td>0.8098</td>\n",
       "      <td>0.8098</td>\n",
       "      <td>0.8098</td>\n",
       "      <td>168565</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10165000</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>2020-11-13</td>\n",
       "      <td>0.8611</td>\n",
       "      <td>0.8799</td>\n",
       "      <td>0.8450</td>\n",
       "      <td>0.8526</td>\n",
       "      <td>0.8526</td>\n",
       "      <td>257584</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10165001</th>\n",
       "      <td>ENG</td>\n",
       "      <td>Consumer Services</td>\n",
       "      <td>Military/Government/Technical</td>\n",
       "      <td>2020-11-10</td>\n",
       "      <td>0.8100</td>\n",
       "      <td>0.8998</td>\n",
       "      <td>0.7800</td>\n",
       "      <td>0.8620</td>\n",
       "      <td>0.8620</td>\n",
       "      <td>1345131</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10165002 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         symbol             sector                                 industry  \\\n",
       "0         AMSWA         Technology  Computer Software: Prepackaged Software   \n",
       "1         AMSWA         Technology  Computer Software: Prepackaged Software   \n",
       "2         AMSWA         Technology  Computer Software: Prepackaged Software   \n",
       "3         AMSWA         Technology  Computer Software: Prepackaged Software   \n",
       "4         AMSWA         Technology  Computer Software: Prepackaged Software   \n",
       "...         ...                ...                                      ...   \n",
       "10164997    ENG  Consumer Services            Military/Government/Technical   \n",
       "10164998    ENG  Consumer Services            Military/Government/Technical   \n",
       "10164999    ENG  Consumer Services            Military/Government/Technical   \n",
       "10165000    ENG  Consumer Services            Military/Government/Technical   \n",
       "10165001    ENG  Consumer Services            Military/Government/Technical   \n",
       "\n",
       "                date     open     high      low    close  close_adjusted  \\\n",
       "0         2004-04-01   6.6400   7.6000   6.6400   7.4700          3.7886   \n",
       "1         2015-03-24  10.2200  10.5400  10.0600  10.2600          9.1404   \n",
       "2         2006-04-19   7.4000   7.4100   7.2870   7.4100          4.1291   \n",
       "3         2014-08-08   9.1700   9.3400   9.1700   9.2900          8.0998   \n",
       "4         2010-03-16   5.9200   5.9600   5.7500   5.8800          4.0623   \n",
       "...              ...      ...      ...      ...      ...             ...   \n",
       "10164997  2020-11-03   0.8173   0.8400   0.7975   0.8305          0.8305   \n",
       "10164998  2020-11-11   0.8880   0.8880   0.8500   0.8760          0.8760   \n",
       "10164999  2020-11-04   0.8354   0.8600   0.8098   0.8098          0.8098   \n",
       "10165000  2020-11-13   0.8611   0.8799   0.8450   0.8526          0.8526   \n",
       "10165001  2020-11-10   0.8100   0.8998   0.7800   0.8620          0.8620   \n",
       "\n",
       "           volume  split_coefficient  \n",
       "0          136400                1.0  \n",
       "1          255045                1.0  \n",
       "2           80300                1.0  \n",
       "3           28900                1.0  \n",
       "4           34900                1.0  \n",
       "...           ...                ...  \n",
       "10164997   151928                1.0  \n",
       "10164998   426193                1.0  \n",
       "10164999   168565                1.0  \n",
       "10165000   257584                1.0  \n",
       "10165001  1345131                1.0  \n",
       "\n",
       "[10165002 rows x 11 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data = pd.merge(nasdaq_sectors, stock_prices, on=\"symbol\")\n",
    "merged_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-20-1344cb4e45ca>:1: ParserWarning: Falling back to the 'python' engine because the 'c' engine does not support skipfooter; you can avoid this warning by specifying engine='python'.\n",
      "  gross_output = pd.read_csv('gross_output.csv', skiprows=5, skipfooter=6, index_col=1)\n"
     ]
    }
   ],
   "source": [
    "gross_output = pd.read_csv('gross_output.csv', skiprows=5, skipfooter=6, index_col=1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Line</th>\n",
       "      <th>Q1</th>\n",
       "      <th>Q2</th>\n",
       "      <th>Q3</th>\n",
       "      <th>Q4</th>\n",
       "      <th>Q1.1</th>\n",
       "      <th>Q2.1</th>\n",
       "      <th>Q3.1</th>\n",
       "      <th>Q4.1</th>\n",
       "      <th>Q1.2</th>\n",
       "      <th>Q2.2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>All industries</th>\n",
       "      <td>1.0</td>\n",
       "      <td>35838.6</td>\n",
       "      <td>36453.0</td>\n",
       "      <td>36916.7</td>\n",
       "      <td>37205.3</td>\n",
       "      <td>37377.9</td>\n",
       "      <td>37709.1</td>\n",
       "      <td>37991.1</td>\n",
       "      <td>38189.9</td>\n",
       "      <td>37826.8</td>\n",
       "      <td>34260.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Private industries</th>\n",
       "      <td>2.0</td>\n",
       "      <td>31958.1</td>\n",
       "      <td>32523.1</td>\n",
       "      <td>32940.9</td>\n",
       "      <td>33195.7</td>\n",
       "      <td>33349.6</td>\n",
       "      <td>33632.4</td>\n",
       "      <td>33887.0</td>\n",
       "      <td>34052.5</td>\n",
       "      <td>33685.4</td>\n",
       "      <td>30215.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Agriculture, forestry, fishing, and hunting</th>\n",
       "      <td>3.0</td>\n",
       "      <td>457.1</td>\n",
       "      <td>460.9</td>\n",
       "      <td>449.9</td>\n",
       "      <td>454.8</td>\n",
       "      <td>447.0</td>\n",
       "      <td>448.4</td>\n",
       "      <td>453.0</td>\n",
       "      <td>461.3</td>\n",
       "      <td>467.7</td>\n",
       "      <td>416.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Farms</th>\n",
       "      <td>4.0</td>\n",
       "      <td>401.1</td>\n",
       "      <td>405.0</td>\n",
       "      <td>395.8</td>\n",
       "      <td>400.9</td>\n",
       "      <td>392.3</td>\n",
       "      <td>394.1</td>\n",
       "      <td>399.1</td>\n",
       "      <td>405.9</td>\n",
       "      <td>413.1</td>\n",
       "      <td>367.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Forestry, fishing, and related activities</th>\n",
       "      <td>5.0</td>\n",
       "      <td>56.0</td>\n",
       "      <td>55.9</td>\n",
       "      <td>54.1</td>\n",
       "      <td>53.8</td>\n",
       "      <td>54.6</td>\n",
       "      <td>54.2</td>\n",
       "      <td>53.9</td>\n",
       "      <td>55.4</td>\n",
       "      <td>54.6</td>\n",
       "      <td>48.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>General government</th>\n",
       "      <td>96.0</td>\n",
       "      <td>2360.1</td>\n",
       "      <td>2388.0</td>\n",
       "      <td>2417.1</td>\n",
       "      <td>2437.2</td>\n",
       "      <td>2440.6</td>\n",
       "      <td>2463.4</td>\n",
       "      <td>2479.0</td>\n",
       "      <td>2497.9</td>\n",
       "      <td>2499.9</td>\n",
       "      <td>2380.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Government enterprises</th>\n",
       "      <td>97.0</td>\n",
       "      <td>354.8</td>\n",
       "      <td>358.2</td>\n",
       "      <td>360.9</td>\n",
       "      <td>364.5</td>\n",
       "      <td>366.8</td>\n",
       "      <td>371.4</td>\n",
       "      <td>373.5</td>\n",
       "      <td>375.1</td>\n",
       "      <td>372.8</td>\n",
       "      <td>346.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Addenda:</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Private goods-producing industries1</th>\n",
       "      <td>98.0</td>\n",
       "      <td>8721.7</td>\n",
       "      <td>8892.3</td>\n",
       "      <td>9029.4</td>\n",
       "      <td>9031.1</td>\n",
       "      <td>8989.1</td>\n",
       "      <td>9010.3</td>\n",
       "      <td>8966.9</td>\n",
       "      <td>8960.0</td>\n",
       "      <td>8869.9</td>\n",
       "      <td>7789.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Private services-producing industries2</th>\n",
       "      <td>99.0</td>\n",
       "      <td>23236.4</td>\n",
       "      <td>23630.8</td>\n",
       "      <td>23911.5</td>\n",
       "      <td>24164.6</td>\n",
       "      <td>24360.5</td>\n",
       "      <td>24622.1</td>\n",
       "      <td>24920.1</td>\n",
       "      <td>25092.4</td>\n",
       "      <td>24815.5</td>\n",
       "      <td>22426.1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    Line       Q1       Q2  \\\n",
       "        All industries                               1.0  35838.6  36453.0   \n",
       "Private industries                                   2.0  31958.1  32523.1   \n",
       "    Agriculture, forestry, fishing, and hunting      3.0    457.1    460.9   \n",
       "        Farms                                        4.0    401.1    405.0   \n",
       "        Forestry, fishing, and related activities    5.0     56.0     55.9   \n",
       "...                                                  ...      ...      ...   \n",
       "        General government                          96.0   2360.1   2388.0   \n",
       "        Government enterprises                      97.0    354.8    358.2   \n",
       "    Addenda:                                         NaN      NaN      NaN   \n",
       "            Private goods-producing industries1     98.0   8721.7   8892.3   \n",
       "            Private services-producing industries2  99.0  23236.4  23630.8   \n",
       "\n",
       "                                                         Q3       Q4     Q1.1  \\\n",
       "        All industries                              36916.7  37205.3  37377.9   \n",
       "Private industries                                  32940.9  33195.7  33349.6   \n",
       "    Agriculture, forestry, fishing, and hunting       449.9    454.8    447.0   \n",
       "        Farms                                         395.8    400.9    392.3   \n",
       "        Forestry, fishing, and related activities      54.1     53.8     54.6   \n",
       "...                                                     ...      ...      ...   \n",
       "        General government                           2417.1   2437.2   2440.6   \n",
       "        Government enterprises                        360.9    364.5    366.8   \n",
       "    Addenda:                                            NaN      NaN      NaN   \n",
       "            Private goods-producing industries1      9029.4   9031.1   8989.1   \n",
       "            Private services-producing industries2  23911.5  24164.6  24360.5   \n",
       "\n",
       "                                                       Q2.1     Q3.1     Q4.1  \\\n",
       "        All industries                              37709.1  37991.1  38189.9   \n",
       "Private industries                                  33632.4  33887.0  34052.5   \n",
       "    Agriculture, forestry, fishing, and hunting       448.4    453.0    461.3   \n",
       "        Farms                                         394.1    399.1    405.9   \n",
       "        Forestry, fishing, and related activities      54.2     53.9     55.4   \n",
       "...                                                     ...      ...      ...   \n",
       "        General government                           2463.4   2479.0   2497.9   \n",
       "        Government enterprises                        371.4    373.5    375.1   \n",
       "    Addenda:                                            NaN      NaN      NaN   \n",
       "            Private goods-producing industries1      9010.3   8966.9   8960.0   \n",
       "            Private services-producing industries2  24622.1  24920.1  25092.4   \n",
       "\n",
       "                                                       Q1.2     Q2.2  \n",
       "        All industries                              37826.8  34260.0  \n",
       "Private industries                                  33685.4  30215.1  \n",
       "    Agriculture, forestry, fishing, and hunting       467.7    416.6  \n",
       "        Farms                                         413.1    367.9  \n",
       "        Forestry, fishing, and related activities      54.6     48.7  \n",
       "...                                                     ...      ...  \n",
       "        General government                           2499.9   2380.9  \n",
       "        Government enterprises                        372.8    346.0  \n",
       "    Addenda:                                            NaN      NaN  \n",
       "            Private goods-producing industries1      8869.9   7789.0  \n",
       "            Private services-producing industries2  24815.5  22426.1  \n",
       "\n",
       "[100 rows x 11 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gross_output"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>2020 Q1</th>\n",
       "      <th>2020 Q2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Housing</th>\n",
       "      <td>2406.3</td>\n",
       "      <td>2427.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Other real estate</th>\n",
       "      <td>1472.2</td>\n",
       "      <td>1386.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Accommodation</th>\n",
       "      <td>251.5</td>\n",
       "      <td>98.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Administrative and support services</th>\n",
       "      <td>1065.9</td>\n",
       "      <td>954.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ambulatory health care services</th>\n",
       "      <td>1144.1</td>\n",
       "      <td>924.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Transportation and warehousing</th>\n",
       "      <td>1315.4</td>\n",
       "      <td>987.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Utilities</th>\n",
       "      <td>481.2</td>\n",
       "      <td>478.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wholesale trade</th>\n",
       "      <td>2074.6</td>\n",
       "      <td>1810.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Government</th>\n",
       "      <td>4141.4</td>\n",
       "      <td>4044.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Private industries</th>\n",
       "      <td>33685.4</td>\n",
       "      <td>30215.1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>97 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 2020 Q1  2020 Q2\n",
       "                Housing                           2406.3   2427.1\n",
       "                Other real estate                 1472.2   1386.1\n",
       "            Accommodation                          251.5     98.9\n",
       "            Administrative and support services   1065.9    954.4\n",
       "            Ambulatory health care services       1144.1    924.7\n",
       "...                                                  ...      ...\n",
       "    Transportation and warehousing                1315.4    987.2\n",
       "    Utilities                                      481.2    478.4\n",
       "    Wholesale trade                               2074.6   1810.9\n",
       "Government                                        4141.4   4044.9\n",
       "Private industries                               33685.4  30215.1\n",
       "\n",
       "[97 rows x 2 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gross_output = gross_output.drop('Line', axis=1)\n",
    "gross_output.columns = ['2018 Q1', '2018 Q2', '2018 Q3', '2018 Q4', '2019 Q1', '2019 Q2', '2019 Q3', '2019 Q4', '2020 Q1', '2020 Q2']\n",
    "\n",
    "gross_output = gross_output.dropna()\n",
    "gross_output\n",
    "gross_output_2020 = gross_output.groupby(gross_output.index)[['2020 Q1', '2020 Q2']].mean()\n",
    "gross_output_2020"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                                 2020 Q1  2020 Q2     Result\n",
      "                Housing                           2406.3   2427.1   0.864398\n",
      "                Other real estate                 1472.2   1386.1  -5.848390\n",
      "            Accommodation                          251.5     98.9 -60.675944\n",
      "            Administrative and support services   1065.9    954.4 -10.460644\n",
      "            Ambulatory health care services       1144.1    924.7 -19.176645\n",
      "...                                                  ...      ...        ...\n",
      "    Transportation and warehousing                1315.4    987.2 -24.950585\n",
      "    Utilities                                      481.2    478.4  -0.581879\n",
      "    Wholesale trade                               2074.6   1810.9 -12.710884\n",
      "Government                                        4141.4   4044.9  -2.330130\n",
      "Private industries                               33685.4  30215.1 -10.302089\n",
      "\n",
      "[97 rows x 3 columns]\n"
     ]
    }
   ],
   "source": [
    "\n",
    "x=0\n",
    "result = [] \n",
    "for value in gross_output_2020[\"2020 Q1\"]: \n",
    "    quarter2 = gross_output_2020.iloc[x,1]\n",
    "    percent_change = (((quarter2/value)*100)-100)\n",
    "    result.append(percent_change) \n",
    "    x= x+1\n",
    "       \n",
    "gross_output_2020[\"Result\"] = result    \n",
    "print(gross_output_2020)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>date</th>\n",
       "      <th>qtr</th>\n",
       "      <th>eps_est</th>\n",
       "      <th>eps</th>\n",
       "      <th>release_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>A</td>\n",
       "      <td>2012-11-19</td>\n",
       "      <td>10/2012</td>\n",
       "      <td>0.800</td>\n",
       "      <td>0.84</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>A</td>\n",
       "      <td>2013-02-14</td>\n",
       "      <td>01/2013</td>\n",
       "      <td>0.660</td>\n",
       "      <td>0.63</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>A</td>\n",
       "      <td>2013-05-14</td>\n",
       "      <td>04/2013</td>\n",
       "      <td>0.670</td>\n",
       "      <td>0.77</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>A</td>\n",
       "      <td>2013-08-14</td>\n",
       "      <td>07/2013</td>\n",
       "      <td>0.620</td>\n",
       "      <td>0.68</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>A</td>\n",
       "      <td>2013-11-14</td>\n",
       "      <td>10/2013</td>\n",
       "      <td>0.760</td>\n",
       "      <td>0.81</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160655</th>\n",
       "      <td>ZYXI</td>\n",
       "      <td>2019-10-29</td>\n",
       "      <td>Q3</td>\n",
       "      <td>0.057</td>\n",
       "      <td>0.06</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160656</th>\n",
       "      <td>ZYXI</td>\n",
       "      <td>2020-02-27</td>\n",
       "      <td>Q4</td>\n",
       "      <td>0.077</td>\n",
       "      <td>0.09</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160657</th>\n",
       "      <td>ZYXI</td>\n",
       "      <td>2020-04-28</td>\n",
       "      <td>Q1</td>\n",
       "      <td>0.063</td>\n",
       "      <td>0.09</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160658</th>\n",
       "      <td>ZYXI</td>\n",
       "      <td>2020-07-28</td>\n",
       "      <td>Q2</td>\n",
       "      <td>0.086</td>\n",
       "      <td>0.09</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160659</th>\n",
       "      <td>ZYXI</td>\n",
       "      <td>2020-10-27</td>\n",
       "      <td>Q3</td>\n",
       "      <td>0.053</td>\n",
       "      <td>0.04</td>\n",
       "      <td>post</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>77282 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       symbol        date      qtr  eps_est   eps release_time\n",
       "14          A  2012-11-19  10/2012    0.800  0.84         post\n",
       "15          A  2013-02-14  01/2013    0.660  0.63         post\n",
       "16          A  2013-05-14  04/2013    0.670  0.77         post\n",
       "17          A  2013-08-14  07/2013    0.620  0.68         post\n",
       "18          A  2013-11-14  10/2013    0.760  0.81         post\n",
       "...       ...         ...      ...      ...   ...          ...\n",
       "160655   ZYXI  2019-10-29       Q3    0.057  0.06         post\n",
       "160656   ZYXI  2020-02-27       Q4    0.077  0.09         post\n",
       "160657   ZYXI  2020-04-28       Q1    0.063  0.09         post\n",
       "160658   ZYXI  2020-07-28       Q2    0.086  0.09         post\n",
       "160659   ZYXI  2020-10-27       Q3    0.053  0.04         post\n",
       "\n",
       "[77282 rows x 6 columns]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "earnings_latest = pd.read_csv('earnings_latest.csv')\n",
    "\n",
    "earnings_latest = earnings_latest.dropna()\n",
    "earnings_latest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>symbol</th>\n",
       "      <th>date</th>\n",
       "      <th>dividend</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2016-11-15</td>\n",
       "      <td>0.3900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2011-05-17</td>\n",
       "      <td>0.1600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2008-05-13</td>\n",
       "      <td>0.1100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2011-02-15</td>\n",
       "      <td>0.1600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>2012-02-14</td>\n",
       "      <td>0.2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250144</th>\n",
       "      <td>EBTC</td>\n",
       "      <td>2020-11-09</td>\n",
       "      <td>0.1750</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250145</th>\n",
       "      <td>EFAS</td>\n",
       "      <td>2020-11-04</td>\n",
       "      <td>0.0525</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250146</th>\n",
       "      <td>EFBI</td>\n",
       "      <td>2020-11-12</td>\n",
       "      <td>0.0500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250147</th>\n",
       "      <td>CDL</td>\n",
       "      <td>2020-11-12</td>\n",
       "      <td>0.1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>250148</th>\n",
       "      <td>FANG</td>\n",
       "      <td>2020-11-10</td>\n",
       "      <td>0.3750</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>250149 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       symbol        date  dividend\n",
       "0        MSFT  2016-11-15    0.3900\n",
       "1        MSFT  2011-05-17    0.1600\n",
       "2        MSFT  2008-05-13    0.1100\n",
       "3        MSFT  2011-02-15    0.1600\n",
       "4        MSFT  2012-02-14    0.2000\n",
       "...       ...         ...       ...\n",
       "250144   EBTC  2020-11-09    0.1750\n",
       "250145   EFAS  2020-11-04    0.0525\n",
       "250146   EFBI  2020-11-12    0.0500\n",
       "250147    CDL  2020-11-12    0.1111\n",
       "250148   FANG  2020-11-10    0.3750\n",
       "\n",
       "[250149 rows x 3 columns]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dividends_latest = pd.read_csv('dividends_latest.csv')\n",
    "\n",
    "dividends_latest = dividends_latest.dropna()\n",
    "dividends_latest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "dividends_stocks = pd.merge(dividends_latest, stock_prices, on='symbol', how='inner')\n",
    "dividends_stocks_2020 = dividends_stocks[dividends_stocks['date_x'].str.contains('2020')]\n",
    "del dividends_stocks_2020['date_y']\n",
    "dividends_stocks_2020 = dividends_stocks_2020.rename({'date_x': 'date'}, axis=1)\n",
    "dividends_stocks_2020"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "dividends_stocks_2020"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "ename": "MemoryError",
     "evalue": "Unable to allocate 359. MiB for an array with shape (2, 23528435) and data type object",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mMemoryError\u001b[0m                               Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-40-cf43986a244a>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mearnings_stocks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmerge\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mearnings_latest\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mstock_prices\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mon\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34m'symbol'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mhow\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34m'inner'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[0mearnings_stocks_2020\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mearnings_stocks\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mearnings_stocks\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'date_x'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mstr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcontains\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'2020'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[1;32mdel\u001b[0m \u001b[0mearnings_stocks_2020\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'date_y'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      4\u001b[0m \u001b[0mearnings_stocks_2020\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mearnings_stocks_2020\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mrename\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m{\u001b[0m\u001b[1;34m'date_x'\u001b[0m\u001b[1;33m:\u001b[0m \u001b[1;34m'date'\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      5\u001b[0m \u001b[0mearnings_stocks_2020\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\reshape\\merge.py\u001b[0m in \u001b[0;36mmerge\u001b[1;34m(left, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator, validate)\u001b[0m\n\u001b[0;32m     72\u001b[0m     \u001b[0mvalidate\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m ) -> \"DataFrame\":\n\u001b[1;32m---> 74\u001b[1;33m     op = _MergeOperation(\n\u001b[0m\u001b[0;32m     75\u001b[0m         \u001b[0mleft\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     76\u001b[0m         \u001b[0mright\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\reshape\\merge.py\u001b[0m in \u001b[0;36m__init__\u001b[1;34m(self, left, right, how, on, left_on, right_on, axis, left_index, right_index, sort, suffixes, copy, indicator, validate)\u001b[0m\n\u001b[0;32m    650\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mright_join_keys\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    651\u001b[0m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mjoin_names\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 652\u001b[1;33m         ) = self._get_merge_keys()\n\u001b[0m\u001b[0;32m    653\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    654\u001b[0m         \u001b[1;31m# validate the merge keys dtypes. We may need to coerce\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\reshape\\merge.py\u001b[0m in \u001b[0;36m_get_merge_keys\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m   1061\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1062\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mright_drop\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 1063\u001b[1;33m             \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mright\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_drop_labels_or_levels\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright_drop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   1064\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1065\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mleft_keys\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mright_keys\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mjoin_names\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36m_drop_labels_or_levels\u001b[1;34m(self, keys, axis)\u001b[0m\n\u001b[0;32m   1635\u001b[0m         \u001b[1;31m# This ensures that we always perform exactly one copy.\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1636\u001b[0m         \u001b[1;31m# ``copy`` and/or ``inplace`` options could be added in the future.\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 1637\u001b[1;33m         \u001b[0mdropped\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   1638\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1639\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;33m==\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\u001b[0m in \u001b[0;36mcopy\u001b[1;34m(self, deep)\u001b[0m\n\u001b[0;32m   5661\u001b[0m         \u001b[0mdtype\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mobject\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5662\u001b[0m         \"\"\"\n\u001b[1;32m-> 5663\u001b[1;33m         \u001b[0mdata\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_mgr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdeep\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mdeep\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   5664\u001b[0m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_clear_item_cache\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   5665\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_constructor\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m__finalize__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34m\"copy\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36mcopy\u001b[1;34m(self, deep)\u001b[0m\n\u001b[0;32m    800\u001b[0m             \u001b[0mnew_axes\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    801\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 802\u001b[1;33m         \u001b[0mres\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"copy\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdeep\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mdeep\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    803\u001b[0m         \u001b[0mres\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnew_axes\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    804\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mres\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py\u001b[0m in \u001b[0;36mapply\u001b[1;34m(self, f, align_keys, **kwargs)\u001b[0m\n\u001b[0;32m    404\u001b[0m                 \u001b[0mapplied\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mb\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mf\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    405\u001b[0m             \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 406\u001b[1;33m                 \u001b[0mapplied\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mb\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    407\u001b[0m             \u001b[0mresult_blocks\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_extend_blocks\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mapplied\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mresult_blocks\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    408\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\blocks.py\u001b[0m in \u001b[0;36mcopy\u001b[1;34m(self, deep)\u001b[0m\n\u001b[0;32m    677\u001b[0m         \u001b[0mvalues\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    678\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mdeep\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 679\u001b[1;33m             \u001b[0mvalues\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mvalues\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    680\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmake_block_same_class\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvalues\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mndim\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mndim\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    681\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mMemoryError\u001b[0m: Unable to allocate 359. MiB for an array with shape (2, 23528435) and data type object"
     ]
    }
   ],
   "source": [
    "\n",
    "earnings_stocks = pd.merge(earnings_latest, stock_prices, on='symbol', how='inner')\n",
    "earnings_stocks_2020 = earnings_stocks[earnings_stocks['date_x'].str.contains('2020')]\n",
    "del earnings_stocks_2020['date_y']\n",
    "earnings_stocks_2020 = earnings_stocks_2020.rename({'date_x': 'date'}, axis=1)\n",
    "earnings_stocks_2020"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
